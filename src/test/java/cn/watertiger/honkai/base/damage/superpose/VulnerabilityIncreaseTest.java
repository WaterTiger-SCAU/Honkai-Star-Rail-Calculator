package cn.watertiger.honkai.base.damage.superpose;

import cn.watertiger.honkai.base.util.DoubleFormatUtil;
import com.google.common.collect.Lists;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;

import java.util.List;
import java.util.stream.Stream;

class VulnerabilityIncreaseTest {
    public static Stream<Arguments> increaseListProvider() {
        return Stream.of(
                Arguments.of(
                        // 光锥 - 雨一直下
                        Lists.newArrayList("12%"),
                        // 期望
                        "112%"
                ),
                Arguments.of(
                        // none
                        Lists.newArrayList("12%", "12%"),
                        // 期望
                        "124%"
                )
        );
    }

    @ParameterizedTest
    @MethodSource("increaseListProvider")
    void test(List<String> increaseTextList, String expectText) {
        VulnerabilityIncrease vulnerabilityIncrease = new VulnerabilityIncrease();

        increaseTextList.stream()
                .map(DoubleFormatUtil::formatByText)
                .forEach(vulnerabilityIncrease::superpose);

        double total = vulnerabilityIncrease.calculateTotal();

        Assertions.assertEquals(total, DoubleFormatUtil.formatByText(expectText));
    }
}